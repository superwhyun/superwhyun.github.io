<!doctype html>
<html>

<head>

  <title>
    
      증명사진 포토프린팅용 콜라주 이미지 만들기 | U2PIA
    
  </title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/syntax.css">
  <!-- Use Atom -->
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="U2PIA" />
  <!-- RSS-v2.0
  <link href="/rss-feed.xml" type="application/rss+xml" rel="alternate" title="U2PIA | Joy of learning"/>
  //-->


  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Source+Code+Pro">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">

  <script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <!-- Google Analytics -->
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'superwhyun3@gmail.com', 'auto');
  ga('send', 'pageview');
</script>


  <!-- Use Jekyll SEO plugin -->
  <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>증명사진 포토프린팅용 콜라주 이미지 만들기 | U2PIA</title>
<meta name="generator" content="Jekyll v3.6.2" />
<meta property="og:title" content="증명사진 포토프린팅용 콜라주 이미지 만들기" />
<meta name="author" content="Wook Hyun" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="증명사진 스캔 파일을 업로드하면, 여권/비자/반명함/증명사진 규격으로 프린트할 수 있도록 크기를 잡아주고 collage를 만들어 주는 웹 서비스로 뜻밖에 유료로 서비스하는 곳이 많음. express, node.js를 이용해서 drag &amp; drop으로 file upload하고, 원하는 규격별로 사이즈 잡은 후에 photo-collage 라이브러리를 이용해 A4 한장에 여러 장의 사진이 배치되도록 함." />
<meta property="og:description" content="증명사진 스캔 파일을 업로드하면, 여권/비자/반명함/증명사진 규격으로 프린트할 수 있도록 크기를 잡아주고 collage를 만들어 주는 웹 서비스로 뜻밖에 유료로 서비스하는 곳이 많음. express, node.js를 이용해서 drag &amp; drop으로 file upload하고, 원하는 규격별로 사이즈 잡은 후에 photo-collage 라이브러리를 이용해 A4 한장에 여러 장의 사진이 배치되도록 함." />
<link rel="canonical" href="http://localhost:4000/documentation/dev-log-idphoto.html" />
<meta property="og:url" content="http://localhost:4000/documentation/dev-log-idphoto.html" />
<meta property="og:site_name" content="U2PIA" />
<meta property="og:image" content="http://localhost:4000/id_photo.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-02-02T00:00:00+09:00" />
<script type="application/ld+json">
{"description":"증명사진 스캔 파일을 업로드하면, 여권/비자/반명함/증명사진 규격으로 프린트할 수 있도록 크기를 잡아주고 collage를 만들어 주는 웹 서비스로 뜻밖에 유료로 서비스하는 곳이 많음. express, node.js를 이용해서 drag &amp; drop으로 file upload하고, 원하는 규격별로 사이즈 잡은 후에 photo-collage 라이브러리를 이용해 A4 한장에 여러 장의 사진이 배치되도록 함.","author":{"@type":"Person","name":"Wook Hyun"},"@type":"BlogPosting","url":"http://localhost:4000/documentation/dev-log-idphoto.html","image":"http://localhost:4000/id_photo.png","headline":"증명사진 포토프린팅용 콜라주 이미지 만들기","dateModified":"2018-02-02T00:00:00+09:00","datePublished":"2018-02-02T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/documentation/dev-log-idphoto.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


</head>


<body>

<div class="container">
  <header class="site-header">
  <h3 class="site-title">
    <a href="/">U2PIA</a>
  </h3>
  <nav class="menu-list">
    
      <a href="/pages/articles.html" class="menu-link">Articles</a>
    
      <a href="/pages/resources.html" class="menu-link">Learning Resources</a>
    
      <a href="/pages/upcoming.html" class="menu-link">Upcoming</a>
    
      <a href="/pages/documentation.html" class="menu-link">Documentation</a>
    
      <a href="/pages/about.html" class="menu-link">About</a>
    
      <a href="/pages/contact.html" class="menu-link">Contact</a>
    

    
      <a href="mailto:superwhyun3@gmail.com" class="menu-link" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i></a>
    
      <a href="feed.xml" class="menu-link" target="_blank"><i class="fa fa-rss-square" aria-hidden="true"></i></a>
    
  </nav>
  <div class="dropdown">
    <button class="dropbtn"><i class="fa fa-bars" aria-hidden="true"></i></button>
    <div class="dropdown-content">
      
        <a href="/pages/articles.html" class="menu-link">Articles</a>
      
        <a href="/pages/resources.html" class="menu-link">Learning Resources</a>
      
        <a href="/pages/upcoming.html" class="menu-link">Upcoming</a>
      
        <a href="/pages/documentation.html" class="menu-link">Documentation</a>
      
        <a href="/pages/about.html" class="menu-link">About</a>
      
        <a href="/pages/contact.html" class="menu-link">Contact</a>
      

      
        <a href="mailto:superwhyun3@gmail.com" class="menu-link" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i></a>
      
        <a href="feed.xml" class="menu-link" target="_blank"><i class="fa fa-rss-square" aria-hidden="true"></i></a>
      
    </div>
  </div>
</header>

  <div class="posts-wrapper">
    <div class="page-content">
  <h1>
    증명사진 포토프린팅용 콜라주 이미지 만들기
  </h1>

  <span class="post-date">
    Written on
    
    February
    2nd
      ,
    2018
    by
    
      Wook Hyun
    
  </span>

  
    <div class="featured-image">
      <img src="/assets/img/id_photo.png">
    </div>
  

  <article>
    <p>증명사진 스캔 파일을 업로드하면, 여권/비자/반명함/증명사진 규격으로 프린트할 수 있도록 크기를 잡아주고 collage를 만들어 주는 웹 서비스로 뜻밖에 유료로 서비스하는 곳이 많음. express, node.js를 이용해서 drag &amp; drop으로 file upload하고, 원하는 규격별로 사이즈 잡은 후에 photo-collage 라이브러리를 이용해 A4 한장에 여러 장의 사진이 배치되도록 함.</p>

<h1 id="소스코드-다운-받기">소스코드 다운 받기</h1>

<p>TBD: github에 업로드 예정.</p>

<h1 id="개발구동-환경설정">개발/구동 환경설정</h1>

<p>package.json에 기재된 라이브러리들을 설치해 준다.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">
</span><span class="p">{</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IDphoto"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.1.0"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"private"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"node app.js"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"dependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"body-parser"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~1.13.2"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"bootstrap"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~3.3.7"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"canvas"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.6.9"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"ejs"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~2.5.2"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"ejs-locals"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~1.0.2"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"express"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~4.14.0"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"jquery"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~3.1.0"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"multer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~1.2.0"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"multiparty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~4.1.2"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"photo-collage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~1.0.0"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"serve-index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~1.8.0"</span><span class="w">
        </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>package.json이 있는 디렉토리에서 아래 명령을 실행.</p>
<blockquote>
  <p>$ npm install</p>
</blockquote>

<p>맥의 경우에는 아래의 명령어를 통해 필요한 라이브러리들을 설치하도록 한다. 리눅스의 경우에는 딱히 신경 쓰지 않아도 된다.</p>

<blockquote>
  <p>brew install pkg-config cairo pango libpng jpeg giflib</p>
</blockquote>

<h3 id="trouble-shooting">Trouble shooting</h3>
<ul>
  <li>node canvas 관련 에러 나오면, <a href="https://github.com/Automattic/node-canvas">여기</a> 참고</li>
  <li>libpng 에러가 나올땐 <a href="https://github.com/Automattic/node-canvas/wiki/installation---osx#installing-cairo">여기</a> 참고</li>
  <li>Pixman 관련 에러가 나오면 <a href="http://macappstore.org/pixman/">여기</a> 참고</li>
  <li>node.js는 비동기로 동작하기 때문에 생성된 collage 사진을 지우면 오동작함. 그래서, 할수없이 container내에 위치시키도록 했음. 즉, 컨테이너 내려가면 같이 삭제됨. 또한, 파일이름은 난수로 생성되어 외부 접근이 불가하므로 프라이버시 이슈는 없을 듯하나… 개선은 필요한 부분.</li>
</ul>

<h1 id="도커-이미지로-만들기">도커 이미지로 만들기</h1>

<p>도커에서 구동되게 하기 위해 이미지를 만들때 아래와 같이 함.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">FROM node</span>
<span class="s">WORKDIR /usr/src/app</span>
<span class="s">COPY ./site /usr/src/app</span>
<span class="s">EXPOSE 5959</span>
<span class="s">RUN npm install</span>
<span class="s">CMD npm start</span>
</code></pre></div></div>

<p>docker-compose.yml에는 아래와 같이 구성함.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="na">idphoto</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">idphoto</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">5959:5959</span>
    <span class="na">build</span><span class="pi">:</span> <span class="s">./app/ID_photo</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">frontend</span>
      <span class="pi">-</span> <span class="s">traefik</span>
    <span class="na">labels</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">traefik.port=5959'</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">traefik.enable=true'</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">traefik.docker.network=traefik'</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">traefik.backend=idphoto'</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">traefik.frontend.rule=Host:idphoto.u2pia.local'</span>   
    <span class="na">deploy</span><span class="pi">:</span>
      <span class="na">replicas </span><span class="pi">:</span> <span class="s">1</span>    
      <span class="na">restart_policy</span><span class="pi">:</span>
        <span class="na">condition</span><span class="pi">:</span> <span class="s">on-failure</span>
</code></pre></div></div>


  </article>

  


  <div class="post-share">
    <div class="post-date">Feel free to share!</div>
    <div class="sharing-icons">
      <a href="https://twitter.com/intent/tweet?text=증명사진 포토프린팅용 콜라주 이미지 만들기&amp;url=/documentation/dev-log-idphoto.html" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/documentation/dev-log-idphoto.html&amp;title=증명사진 포토프린팅용 콜라주 이미지 만들기" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
      <a href="https://plus.google.com/share?url=/documentation/dev-log-idphoto.html" target="_blank"><i class="fa fa-google-plus" aria-hidden="true"></i></a>
    </div>
  </div>

  <div class="related">
    <h2>You may also enjoy...</h2>
    
    <ul class="related-posts">
      
        
          
          
        
      
    </ul>
  </div>

  

</div>

  </div>
  <footer class="footer">
  
    <a href="mailto:superwhyun3@gmail.com" class="menu-link" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i></a>
  
    <a href="feed.xml" class="menu-link" target="_blank"><i class="fa fa-rss-square" aria-hidden="true"></i></a>
  
  <div class="post-date"><a href="/">U2PIA | Joy of learning by Wook Hyun</a></div>
</footer>

</div>

</body>
</html>
